TODO: sort alt masking - gets an output with all masks one way but with alternating

 currently images are black due to nans and infs
 channel mask last layer resnet output seems to get too large so exp overflows
 but channel masking seems ok
 so issue in weights or inputs
 - could be to do with initialisation or data preprocess

 Looking at the two channel masks separately (ie. layer group 1 only or layer group 2 only:
 Checkerboard on it's own
    Seems OK with all masks alt, but black outputs and nan loss if alt masks
    Ok with 2 or 3 alt layers
    But with 4 alt layers after one or two updates the resnet values blow up and cause issue described
    Changing resnet doesn't seem to fix, but resnet seems to be issue leading on to overflow
    - Resnet?
    - Post-resnet?
    - Input to resnet?

Looked at solutions here, adding tanh to log_scale outputs helped with nan, still needs work though!

layer group 1 on its own works on debug dataset now and on faces
layer group 2 on its own works on debug dataset now

So merging them is an issue! Doesn't work as well as layer group 1 on own though does get some of the way
Doesn't work with merged (all 3 layer groups) on celeb faces

Layer 1 and layer 3 seems to work
Doesn't work layer 1 squeeze + un and layer 3
For layer 1 + layer 3 both un/squeeze type 1 and 2 don't work

* Look at squeeze / unsqueeze

TODO: work on nan loss - seems ok with low enough LR - is there an issue? Regularisation? LR schedule?
TODO: factor out intermediate layer (half of) outputs see paper 3.6
TODO: debug - get toy example to train